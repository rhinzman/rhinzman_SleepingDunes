<!DOCTYPE html>
<html>
  <head>
    
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Data Collector for AGOL</title>
  <style>
    html,
    body {
     padding: 0;
     margin: 0;
     height: 100%;
     width: 100%;
     display: flex;
    }

    #viewDiv {
     padding: 0;
     margin: 0;
     height: 100%;
     flex: 1;
    }

    .sidebar {
      position: relative;
      width: 400px;
      height: 100vh;
      background-color: white;
      box-shadow: 2px 0 5px rgba(0,0,0,0.3);
      z-index: 15;
      overflow-y: auto;
      flex-shrink: 0;
    }

    .sidebar-content {
      padding: 20px;
    }

    .sidebar h2 {
      color: #0079c1;
      margin-top: 0;
      border-bottom: 2px solid #0079c1;
      padding-bottom: 10px;
    }

    .sidebar p {
      line-height: 1.6;
      margin-bottom: 15px;
      color: #333;
    }

    .image-container {
      text-align: center;
      margin: 20px 0;
    }

    .sbd-image {
      width: 100%;
      max-width: 360px;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      margin-bottom: 8px;
    }

    .image-caption {
      font-size: 12px;
      color: #666;
      font-style: italic;
      margin: 5px 0 15px 0;
    }

     .addRecordBtn {
  position: absolute;
  z-index: 10;
  top: 10px;
  right: 10px;
  background-color: #0079c1;
  color: white;
  padding: 8px 16px;
  border: none;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  text-decoration: none;
}

.addRecordBtn:hover {
  background-color: #005a87;
}

.sidebar-survey-btn {
  display: inline-block;
  background-color: #0079c1;
  color: white;
  padding: 12px 24px;
  border: none;
  border-radius: 6px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  text-decoration: none;
  transition: background-color 0.3s ease;
  width: 80%;
  text-align: center;
}

.sidebar-survey-btn:hover {
  background-color: #005a87;
  text-decoration: none;
  color: white;
}

.esri-legend {
  background-color: rgba(255, 255, 255, 0.95);
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  max-width: 250px;
  min-width: 180px;
  width: auto;
  margin-bottom: 10px;
  padding: 8px;
}

.esri-legend__title {
  color: #0079c1;
  font-weight: bold;
}

.esri-legend__layer {
  margin-bottom: 5px;
}

.esri-legend__layer-title {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 3px;
}

.esri-legend__service {
  padding: 2px 0;
}

.esri-legend__symbol {
  margin-right: 8px;
}
    
   </style>
  <!-- importing the css and lic=braries from esri js -->
  <link rel="stylesheet" href="https://js.arcgis.com/4.26/esri/themes/light/main.css" />
  <script src="https://js.arcgis.com/4.26/"></script>
  <!-- loading the modules -->
  <script>
    require([ "esri/config","esri/Map", "esri/views/MapView", "esri/widgets/Search","esri/widgets/Locate", "esri/layers/FeatureLayer", "esri/WebMap", "esri/widgets/Legend", "esri/renderers/SimpleRenderer", "esri/symbols/SimpleFillSymbol" ], 
    (esriConfig,Map, MapView,Search, Locate, FeatureLayer, WebMap, Legend, SimpleRenderer, SimpleFillSymbol) => {
      esriConfig.apiKey = "AAPKd744f2fda2e347d9a3cf7faf3473cfaczN_o6-pVEC0xDG9THThI-plcBTYdOZQwfAaWLFCk-7w8cNq-B8MvENgmb2NpNTXc";
      
      // Create a simple map with OpenStreetMap basemap
      const map = new Map({
        basemap: "topo-vector"
      });
      
      const view = new MapView({
        container: "viewDiv",
        map: map,
        center: [-86.0, 45.0], // Sleeping Bear Dunes area
        zoom: 9
      });
      
      // Add layers after view loads
      view.when(() => {
        // Add UW-Madison layer with sublayer 2 first (bottom layer)
        const uwMadisonLayer = new FeatureLayer({
          portalItem: {
            id: "b489341a02814365a55222ff97716e96"
          },
          layerId: 2,
          opacity: 0.5  // 50% transparent
        });
        map.add(uwMadisonLayer);
        
        // Your survey layer (added last to be on top)
        const featureLayer = new FeatureLayer({
          url: "https://services.arcgis.com/HRPe58bUyBqyyiCt/arcgis/rest/services/survey123_013e4f22f11947f583db89fb1b391449/FeatureServer"
        });
        // Exclude survey layer from legend
        featureLayer.legendEnabled = false;
        map.add(featureLayer);
        
        // Add a popup template to the feature layer
        featureLayer.popupTemplate = {
          title: "{Name}",
          content: [
            {
              type: "attachments"
            },
            {
              type: "fields",
              fieldInfos: [
                {
                  fieldName: "Description",
                  label: "Description"
                },
                {
                  fieldName: "Name",
                  label: "Location Name"
                }
              ]
            }
          ]
        };
        
        // Create legend widget after layers are added
        const legend = new Legend({
          view: view,
          style: {
            type: "card",
            layout: "auto"
          }
        });
        
        // Add the legend to the top right corner
        view.ui.add(legend, {
          position: "top-right",
          index: 0
        });
        
      });
      
      const searchWidget = new Search({
        view: view
      });
      
      // Add the search widget to the bottom right corner of the view
      view.ui.add(searchWidget, {
        position: "bottom-right",
        index: 0
      });
      //creating a locate widget
      const locateBtn = new Locate({
        view: view
      });
      
      // Add the locate widget to the top left corner of the view
      view.ui.add(locateBtn, {
        position: "top-left",
      });    
      
      // Pan to location functionality
      const locations = {
        'sleeping-bear-dunes': { center: [-86.0585, 44.8614], zoom: 12 },
        'glen-haven': { center: [-86.0194, 44.9039], zoom: 14 },
        'dune-climb': { center: [-86.0378, 44.8328], zoom: 15 },
        'empire-beach': { center: [-86.0564, 44.8086], zoom: 14 },
        'pierce-stocking': { center: [-86.0456, 44.8456], zoom: 13 }
      };
      
      // Wait for DOM to be ready
      view.when(() => {
        const locationSelect = document.getElementById('locationSelect');
        const panButton = document.getElementById('panButton');
        
        panButton.addEventListener('click', () => {
          const selectedValue = locationSelect.value;
          if (selectedValue && locations[selectedValue]) {
            const location = locations[selectedValue];
            view.goTo({
              center: location.center,
              zoom: location.zoom
            }, {
              duration: 2000,
              easing: "ease-in-out"
            });
          } else {
            alert('Please select a location first!');
          }
        });
        
        // Also allow pan on selection change
        locationSelect.addEventListener('change', () => {
          const selectedValue = locationSelect.value;
          if (selectedValue && locations[selectedValue]) {
            const location = locations[selectedValue];
            view.goTo({
              center: location.center,
              zoom: location.zoom
            }, {
              duration: 2000,
              easing: "ease-in-out"
            });
          }
        });
      });
     
     });
    </script>

  </head>
  <body>
    <div id="sidebar" class="sidebar">
      <div class="sidebar-content">
        <h2>Sleeping Bear Dunes National Lakeshore</h2>
        
        <!-- Add Image -->
        <div class="image-container">
          <img src="https://raw.githubusercontent.com/rhinzman/rhinzman_SleepingDunes/main/SBD.jpg" alt="Sleeping Bear Dunes" class="sbd-image" /> 
          <p class="image-caption">Sleeping Bear Dunes National Lakeshore</p>
        </div>
        
        <p>
          Sleeping Bear Dunes National Lakeshore is a magnificent protected area located along the 
          northwestern coast of Michigan's Lower Peninsula. Established in 1970, this stunning 
          landscape encompasses over 71,000 acres of pristine shoreline, towering sand dunes, 
          and diverse ecosystems.
        </p>
        <p>
          The park is famous for its massive sand dunes that rise up to 450 feet above Lake Michigan, 
          offering breathtaking panoramic views of the lake and surrounding landscape. The area gets 
          its name from an Ojibwe legend about a mother bear and her two cubs who swam across Lake 
          Michigan to escape a forest fire.
        </p>
        <p>
          Visitors can enjoy numerous recreational activities including hiking the challenging 
          Dune Climb, exploring historic sites like the Glen Haven Village, swimming at pristine 
          beaches, and camping under star-filled skies. The park also protects important habitats 
          for wildlife and rare plant species.
        </p>
        <p>
          The Sleeping Bear Dunes were voted "The Most Beautiful Place in America" by viewers of 
          ABC's Good Morning America in 2011, highlighting the area's exceptional natural beauty 
          and cultural significance.
        </p>
        
        <!-- Pan to Location Section -->
        <div style="margin: 20px 0; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
          <h3 style="margin-top: 0; color: #0079c1; font-size: 16px;">Navigate to Location</h3>
          <label for="locationSelect" style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Select a location:</label>
          <select id="locationSelect" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; background-color: white;">
            <option value="">Choose a location...</option>
            <option value="sleeping-bear-dunes">Sleeping Bear Dunes</option>
            <option value="glen-haven">Glen Haven Village</option>
            <option value="dune-climb">Dune Climb</option>
            <option value="empire-beach">Empire Beach</option>
            <option value="pierce-stocking">Pierce Stocking Scenic Drive</option>
          </select>
          <button id="panButton" style="margin-top: 10px; background-color: #0079c1; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">Pan to Location</button>
        </div>
        
        <!-- Survey Button moved to sidebar bottom -->
        <div style="margin-top: 30px; text-align: center;">
         <p style="font-weight: bold;"> take the survey to add your travel experience to this map </p>
          <a href="https://survey123.arcgis.com/share/013e4f22f11947f583db89fb1b391449" target="_blank" class="sidebar-survey-btn">Click to Locate</a>
        </div>
      </div>
    </div>
    
    <div id="viewDiv">
    </div>
    

  </body>
</html>